let l=0,n=[],a=1,E=!1,B=0,k=0,r=0,d=0,y=new Map;function q(){const e=document.getElementById("photo-lightbox"),o=document.getElementById("lightbox-image");document.getElementById("lightbox-title"),document.getElementById("lightbox-description");const s=document.querySelector(".close-button"),h=document.querySelector(".prev-button"),f=document.querySelector(".next-button"),p=document.querySelector(".zoom-in"),m=document.querySelector(".zoom-out"),C=document.querySelector(".fullscreen"),D=document.querySelector(".download"),v=document.querySelectorAll(".photo-item");n=Array.from(v).map(t=>{const c=t.querySelector("img"),i=t.dataset.title||t.querySelector(".photo-caption p")?.textContent||"",T=t.dataset.description||"";return{src:c.src,alt:c.alt,title:i,description:T}});function A(){n.forEach((t,c)=>{if(!y.has(c)){const i=new Image;i.src=t.src,y.set(c,i)}})}v.forEach((t,c)=>{t.addEventListener("click",i=>{i.preventDefault(),z(c)})}),s.addEventListener("click",I),e.addEventListener("click",t=>{t.target===e&&I()}),h.addEventListener("click",w),f.addEventListener("click",S),p.addEventListener("click",()=>u(1.2)),m.addEventListener("click",()=>u(.8)),C.addEventListener("click",Y),D.addEventListener("click",$),o.addEventListener("wheel",t=>{t.preventDefault();const c=t.deltaY>0?.9:1.1;u(c)});let x=0,L=0,b=0;o.addEventListener("touchstart",t=>{t.touches.length===2?b=Math.hypot(t.touches[0].clientX-t.touches[1].clientX,t.touches[0].clientY-t.touches[1].clientY):(x=t.touches[0].clientX-r,L=t.touches[0].clientY-d)}),o.addEventListener("touchmove",t=>{if(t.touches.length===2){const c=Math.hypot(t.touches[0].clientX-t.touches[1].clientX,t.touches[0].clientY-t.touches[1].clientY),i=c/b;u(i),b=c}else a>1&&(t.preventDefault(),r=t.touches[0].clientX-x,d=t.touches[0].clientY-L,g())}),o.addEventListener("mousedown",t=>{a>1&&(E=!0,B=t.clientX-r,k=t.clientY-d,o.style.cursor="grabbing")}),document.addEventListener("mousemove",t=>{E&&a>1&&(r=t.clientX-B,d=t.clientY-k,g())}),document.addEventListener("mouseup",()=>{E=!1,o.style.cursor="grab"}),document.addEventListener("keydown",t=>{e.classList.contains("active")&&(t.key==="Escape"&&I(),t.key==="ArrowLeft"&&w(),t.key==="ArrowRight"&&S(),t.key==="+"&&u(1.2),t.key==="-"&&u(.8),t.key==="f"&&Y())}),A()}function z(e){l=e;const o=document.getElementById("photo-lightbox"),s=document.getElementById("lightbox-image"),h=document.getElementById("lightbox-title"),f=document.getElementById("lightbox-description");a=1,r=0,d=0,g();const p=y.get(e);if(p&&p.complete)s.src=n[e].src,s.alt=n[e].alt,h.textContent=n[e].title,f.textContent=n[e].description,o.classList.add("active");else{const m=new Image;m.onload=()=>{s.src=n[e].src,s.alt=n[e].alt,h.textContent=n[e].title,f.textContent=n[e].description,o.classList.add("active"),y.set(e,m)},m.src=n[e].src}document.body.style.overflow="hidden",preloadAdjacentImages(e)}function I(){const e=document.getElementById("photo-lightbox"),o=document.getElementById("lightbox-image");o.classList.add("fade-out"),setTimeout(()=>{e.classList.remove("active"),o.classList.remove("fade-out"),document.body.style.overflow=""},300)}function w(){l=(l-1+n.length)%n.length,X()}function S(){l=(l+1)%n.length,X()}function X(){const e=document.getElementById("lightbox-image"),o=document.getElementById("lightbox-title"),s=document.getElementById("lightbox-description");a=1,r=0,d=0,g(),e.classList.add("fade-out"),setTimeout(()=>{e.src=n[l].src,e.alt=n[l].alt,o.textContent=n[l].title,s.textContent=n[l].description,e.classList.remove("fade-out"),e.classList.add("fade-in"),setTimeout(()=>{e.classList.remove("fade-in")},300)},300)}function u(e){const o=a*e;o>=1&&o<=4&&(a=o,g())}function g(){const e=document.getElementById("lightbox-image");e.style.transform=`translate(${r}px, ${d}px) scale(${a})`}function Y(){const e=document.getElementById("photo-lightbox");document.fullscreenElement?document.exitFullscreen():e.requestFullscreen().catch(o=>{console.error(`Error attempting to enable fullscreen: ${o.message}`)})}function $(){const e=document.getElementById("lightbox-image"),o=document.createElement("a");o.href=e.src,o.download=`photo-${l+1}.jpg`,document.body.appendChild(o),o.click(),document.body.removeChild(o)}document.addEventListener("DOMContentLoaded",q);document.addEventListener("astro:after-swap",q);
